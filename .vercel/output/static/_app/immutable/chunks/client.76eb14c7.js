import{j as l}from"./singletons.3b2afad5.js";const y=l("invalidate_all"),d="/_auth/callback",u="/_auth/signout";let i;function c(){if(!i)throw new Error("svelte-google-auth context not defined. Did you forget to call `initialize(data)` +layout.svelte?");return i}async function _(e,t){i={getData:()=>e.auth,invalidateAll:()=>t()}}async function A(e=["openid","profile","email"]){await g();const t=await f();return new Promise((a,n)=>{google.accounts.oauth2.initCodeClient({client_id:t,scope:e.join(" "),ux_mode:"popup",callback:s=>{const{code:r,scope:w}=s,o=new XMLHttpRequest;o.open("POST",d,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.setRequestHeader("X-Requested-With","XmlHttpRequest"),o.onload=async function(){console.log("Auth code response: "+o.responseText),await c().invalidateAll(),a()},o.onerror=n,o.onabort=n,o.send("code="+r)}}).requestCode()})}async function v(){await fetch(u,{method:"POST"}),window.gapi&&gapi.client.setToken({access_token:""}),await c().invalidateAll()}async function p(e){return new Promise((t,a)=>{const n=document.createElement("script");n.type="text/javascript",n.src=e,n.defer=!0,n.onload=t,n.onerror=a,document.head.appendChild(n)})}async function g(){var e,t;if(!((t=(e=window.google)==null?void 0:e.accounts)!=null&&t.oauth2))return p("https://accounts.google.com/gsi/client")}async function f(){const t=c().getData().client_id;if(!t)throw new Error("svelte-google-auth could not find required data from page data. \nDid you remember to return `hydrateAuth(locals)` in +layout.server.ts?");return t}export{y as a,A as b,_ as i,v as s};
